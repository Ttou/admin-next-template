import{G as b}from"./index.common-402e5511.js";import{b as h}from"./index-bc9ac8d3.js";import{r as c,c as R,o as v,O as y,a1 as C,$ as E,d as T,x as s,C as P,t as S}from"./runtime-core.esm-bundler-487be079.js";import{b as L}from"./ajax-7ef056e0.js";import{g as x}from"./util-be48394f.js";import{b as l,a as f,c as u,T as H}from"./table-f5bf8c20.js";import{b as A,z as m,t as O,d as _,K as D}from"./plugin-vue_export-helper-f8bac1eb.js";import{l as w,m as I,n as k,b as B}from"./_baseClone-d814ff28.js";import{i as F,b as N}from"./isObjectLike-46b91259.js";import{f as G}from"./_flatRest-686bc3c2.js";import{g as M}from"./index-b5d40b0a.js";import"./index-f403bd98.js";import"./index-deddad90.js";import"./dayjs.min-9b18d6c6.js";import"./vue-router-cbdf6480.js";import"./index-4c378dbd.js";var z="[object Object]",Y=Function.prototype,j=Object.prototype,d=Y.toString,q=j.hasOwnProperty,K=d.call(Object);function V(e){if(!F(e)||N(e)!=z)return!1;var t=w(e);if(t===null)return!0;var r=q.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&d.call(r)==K}function $(e,t,r){var o=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(n);++o<n;)a[o]=e[o+t];return a}function U(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function J(e,t){return t.length<2?e:A(e,$(t,0,-1))}function Q(e,t){return t=m(t,e),e=J(e,t),e==null||delete e[O(U(t))]}function W(e){return V(e)?void 0:e}var X=1,Z=2,ee=4,te=G(function(e,t){var r={};if(e==null)return r;var o=!1;t=_(t,function(a){return a=m(a,e),o||(o=a.length>1),a}),I(e,k(e),r),o&&(r=B(r,X|Z|ee,W));for(var n=t.length;n--;)Q(r,t[n]);return r});const re=te,oe={getList(e){return L.get("/demo/list",{params:e})}};function ne(e){const t=c(0),r=R(()=>t.value+"px"),o=h();function n(){const a=document.querySelector("#page");t.value=a.scrollHeight-(o.fixedHeader?20:110)-((e==null?void 0:e.extraHeight)||0)}return v(()=>{n()}),{pageHeight:t,pageHeightPx:r}}function ae(e){const t=c({});function r(i){const g=e.value.formConfig.items.find(p=>p.field===i.field);D(g,i.key,i.value)}function o(){e.value.loading=!0}function n(){e.value.loading=!1}async function a(i){try{o(),await(i==null?void 0:i()),await t.value.commitProxy("query")}finally{n()}}return{tableRef:t,updateFormItem:r,showLoading:o,hideLoading:n,refresh:a}}function ie(){const e=y({tableConfig:{id:x(),showOverflow:!0,border:!0,loading:!1,keepSource:!0,height:"auto",toolbarConfig:{perfect:!0,custom:!0,refresh:!0,zoom:!0,slots:{buttons:"toolbar_buttons"}},editConfig:{trigger:"click",showStatus:!0},customConfig:{storage:!0},formConfig:{items:[{title:"账号",field:"account",itemRender:{name:l.Input,props:{placeholder:"请输入"}}},{title:"昵称",field:"nickname",itemRender:{name:l.Input,props:{placeholder:"请输入"}}},{title:"角色",field:"role",itemRender:{name:l.Select,props:{placeholder:"请选择"},options:[{label:"admin",value:"admin"},{label:"normal",value:"normal"}]}},{title:"状态",field:"status",itemRender:{name:l.Select,props:{placeholder:"请选择"},options:[{label:"禁用",value:"0"},{label:"启用",value:"1"}]}},{title:"时间",field:"date",itemRender:{name:f.FormItemDate,props:{type:"datetimerange",startPlaceholder:"开始时间",endPlaceholder:"结束时间",format:"YYYY-MM-DD HH:mm:ss"}}},{itemRender:{name:f.FormItemBtns}}]},columns:[{type:"checkbox",width:50},{title:"ID",field:"id"},{title:"账号",field:"account"},{title:"邮箱",field:"email"},{title:"昵称",field:"nickname",editRender:{name:u.Input}},{title:"角色",field:"role"},{title:"状态",field:"status",editRender:{name:u.Select,options:[{label:"禁用",value:"0"},{label:"启用",value:"1"}]}},{title:"备注",field:"remark",editRender:{name:u.Input}},{title:"创建时间",field:"createTs",formatter:H.Date}],pagerConfig:{pageSize:15},proxyConfig:{seq:!0,form:!0,props:{result:"content",total:"total"},ajax:{query:async({page:r,form:o})=>(o.date&&(o.start=o.date[0],o.end=o.date[1],o=re(o,["date"])),await oe.getList({pageSize:r.pageSize,current:r.currentPage,...o}))}}}}),t=ae(C(e,"tableConfig"));return{...E(e),tableRefHook:t}}function le({tableRefHook:e}){function t(){e.refresh()}return{handleCustomRefresh:t}}const Pe=T({name:"DemoTable",setup(){const{tableRefHook:e,...t}=ie(),r=le({tableRefHook:e}),{pageHeightPx:o}=ne();return{...t,...r,tableRef:e.tableRef,pageHeightPx:o}},render(){return s("div",{style:{height:this.pageHeightPx}},[s(b,P({ref:"tableRef"},this.tableConfig),{toolbar_buttons:()=>s(M,{type:"primary",link:!0,onClick:this.handleCustomRefresh},{default:()=>[S("自定义刷新")]})})])}});export{Pe as default};
