import{G as p}from"./index.common-fd71511b.js";import{b as h}from"./index-1c08388f.js";import{r as f,c as R,o as v,O as C,a1 as E,_ as y,d as x,x as s,C as L,t as H}from"./runtime-core.esm-bundler-4761d9e9.js";import{b as S}from"./ajax-61a42d1e.js";import{g as _}from"./util-62e172dc.js";import{c as A,C as m,t as P,j as b,K as T}from"./plugin-vue_export-helper-dddd70e4.js";import{i as D,b as l,a as d,c as u,T as I}from"./table-b357b206.js";import{c as G,s as w,n as k}from"./_baseClone-0d0f882b.js";import{f as B}from"./_flatRest-de05c28d.js";import{g as F}from"./index-10f6af84.js";import"./index-808871c1.js";import"./index-368da730.js";import"./dayjs.min-9b18d6c6.js";import"./vue-router-67a58581.js";import"./index-02744a24.js";import"./isObjectLike-46b91259.js";function N(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(n);++i<n;)o[i]=e[i+t];return o}function O(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function M(e,t){return t.length<2?e:A(e,N(t,0,-1))}function Y(e,t){return t=m(t,e),e=M(e,t),e==null||delete e[P(O(t))]}function q(e){return D(e)?void 0:e}var z=1,K=2,V=4,U=B(function(e,t){var r={};if(e==null)return r;var i=!1;t=b(t,function(o){return o=m(o,e),i||(i=o.length>1),o}),G(e,w(e),r),i&&(r=k(r,z|K|V,q));for(var n=t.length;n--;)Y(r,t[n]);return r});const $=U;function J(e){const t=f({});function r(a){const c=e.value.formConfig.items.find(g=>g.field===a.field);T(c,a.key,a.value)}function i(){e.value.loading=!0}function n(){e.value.loading=!1}async function o(a){try{i(),await(a==null?void 0:a()),await t.value.commitProxy("query")}finally{n()}}return{gridRef:t,updateFormItem:r,showLoading:i,hideLoading:n,refresh:o}}const Q={getList(e){return S.get("/demo/list",{params:e})}};function W(e){const t=f(0),r=R(()=>t.value+"px"),i=h();function n(){const o=document.querySelector("#page");t.value=o.scrollHeight-(i.fixedHeader?20:110)-((e==null?void 0:e.extraHeight)||0)}return v(()=>{n()}),{pageHeight:t,pageHeightPx:r}}function X(){const e=C({gridConfig:{id:_(),showOverflow:!0,border:!0,loading:!1,keepSource:!0,height:"auto",toolbarConfig:{perfect:!0,custom:!0,refresh:!0,zoom:!0,slots:{buttons:"toolbar_buttons"}},editConfig:{trigger:"click",showStatus:!0},customConfig:{storage:!0},formConfig:{items:[{title:"账号",field:"account",itemRender:{name:l.Input,props:{placeholder:"请输入"}}},{title:"昵称",field:"nickname",itemRender:{name:l.Input,props:{placeholder:"请输入"}}},{title:"角色",field:"role",itemRender:{name:l.Select,props:{placeholder:"请选择"},options:[{label:"admin",value:"admin"},{label:"normal",value:"normal"}]}},{title:"状态",field:"status",itemRender:{name:l.Select,props:{placeholder:"请选择"},options:[{label:"禁用",value:"0"},{label:"启用",value:"1"}]}},{title:"时间",field:"date",itemRender:{name:d.FormItemDate,props:{type:"datetimerange",startPlaceholder:"开始时间",endPlaceholder:"结束时间",format:"YYYY-MM-DD HH:mm:ss"}}},{itemRender:{name:d.FormItemBtns}}]},columns:[{type:"checkbox",width:50},{title:"ID",field:"id"},{title:"账号",field:"account"},{title:"邮箱",field:"email"},{title:"昵称",field:"nickname",editRender:{name:u.Input}},{title:"角色",field:"role"},{title:"状态",field:"status",editRender:{name:u.Select,options:[{label:"禁用",value:"0"},{label:"启用",value:"1"}]}},{title:"备注",field:"remark",editRender:{name:u.Input}},{title:"创建时间",field:"createTs",formatter:I.Date}],pagerConfig:{pageSize:15},proxyConfig:{seq:!0,form:!0,props:{result:"content",total:"total"},ajax:{query:async({page:r,form:i})=>(i.date&&(i.start=i.date[0],i.end=i.date[1],i=$(i,["date"])),await Q.getList({pageSize:r.pageSize,current:r.currentPage,...i}))}}}}),t=J(E(e,"gridConfig"));return{...y(e),proGridHook:t}}function Z({proGridHook:e}){function t(){e.refresh()}return{handleCustomRefresh:t}}const pe=x({setup(){const{proGridHook:e,...t}=X(),r=Z({proGridHook:e}),{pageHeightPx:i}=W();return{...t,...r,gridRef:e.gridRef,pageHeightPx:i}},render(){return s("div",{style:{height:this.pageHeightPx}},[s(p,L({ref:"gridRef"},this.gridConfig),{toolbar_buttons:()=>s(F,{type:"primary",link:!0,onClick:this.handleCustomRefresh},{default:()=>[H("自定义刷新")]})})])}});export{pe as default};
